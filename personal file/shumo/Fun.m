%材料移动总距离子函数
function S=Fun(d,s) 
DistanV=0;
DistanV=DistanV+245/2*(d(s(1),s(2))+d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(6))+d(s(6),s(8))+d(s(1),s(2))...
                    +d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(10),s(19)))...
                        +282/2*(d(s(1),s(2))+d(s(2),s(3))+d(s(3),s(5))+d(s(5),s(7))+d(s(7),s(8))+d(s(8),s(10))+d(s(10),s(11))+d(s(11),s(16))+d(s(3),s(4))+d(s(4),s(5))...
                    +d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(10),s(14))+d(s(14),s(18)))...
                        +261/3*(d(s(1),s(4))+d(s(4),s(10))+d(s(10),s(11))+d(s(11),s(20))+d(s(5),s(6))+d(s(6),s(7))+d(s(1),s(4))+d(s(4),s(10))+d(s(10),s(12))+d(s(12),s(13))+d(s(13),s(14))...
                    +d(s(14),s(17))+d(s(1),s(4))+d(s(4),s(9))+d(s(9),s(12))+d(s(12),s(13))+d(s(13),s(14))+d(s(14),s(16))+d(s(16),s(17)))...
                        +277/1*(d(s(1),s(2))+d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(10),s(11))...
                    +d(s(11),s(12))+d(s(12),s(13))+d(s(13),s(14))+d(s(14),s(15))+d(s(15),s(16))+d(s(16),s(17))+d(s(17),s(18))+d(s(18),s(19))+d(s(19),s(20)))...
                        +218/3*(d(s(4),s(5))+d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(8))+d(s(8),s(14))+d(s(14),s(15))+d(s(4),s(5))+d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(12))+d(s(12),s(13))+d(s(13),s(14))+d(s(14),s(15))...
                    +d(s(4),s(5))+d(s(5),s(7))+d(s(7),s(9))+d(s(9),s(10))+d(s(10),s(11))+d(s(11),s(12))+d(s(12),s(13))+d(s(13),s(14))+d(s(14),s(15)))...
                        +397/3*(d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(6))+d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(7))+d(s(7),s(8))+d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(7))+d(s(7),s(10)))...
                        +451/3*(d(s(4),s(5))+d(s(5),s(7))+d(s(7),s(8))+d(s(8),s(10))+d(s(10),s(11))+d(s(11),s(12))+d(s(4),s(5))+d(s(5),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(10),s(12))+d(s(12),s(14))...
                    +d(s(4),s(5))+d(s(5),s(8))+d(s(8),s(10))+d(s(10),s(11))+d(s(11),s(12))+d(s(12),s(13))+d(s(13),s(15)))...
                        +234/2*(d(s(1),s(2))+d(s(2),s(3))+d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(10),s(12))+d(s(1),s(2))+d(s(2),s(3))...
                    +d(s(3),s(4))+d(s(4),s(5))+d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(10),s(11))+d(s(11),s(13))+d(s(13),s(14)))...
                        +388/3*(d(s(4),s(5))+d(s(5),s(7))+d(s(7),s(9))+d(s(5),s(6))+d(s(6),s(8))+d(s(8),s(9))+d(s(9),s(10))+d(s(5),s(6))+d(s(6),s(7))+d(s(7),s(8))+d(s(8),s(9))+d(s(9),s(16)))...
                        +389/3*(d(s(9),s(10))+d(s(10),s(11))+d(s(11),s(13))+d(s(9),s(10))+d(s(10),s(12))+d(s(10),s(11))+d(s(11),s(12))+d(s(12),s(13))+d(s(13),s(15)));    
S=DistanV;
end